install.packages("patchwork")
library(patchwork)
load("../240328_RNAseq2nd/analysis/figure_RNAseq.rda")
heatmap
load("../240415_baQFA/integrated_analysis/figure_integrated_analysis.rda")
install.packages("grImport2")
library(grImport2)
fig1a_file <- system.file("SVG", "fig1a.svg", package = "grImport2")
fig1a <- readPicture(fig1a_file)
fig1a_file <- system.file(fig1a.svg", package = "grImport2")
fig1a_file <- system.file("fig1a.svg", package = "grImport2")
fig1a <- readPicture(fig1a_file)
fig1a_file <- system.file("./fig1a.svg", package = "grImport2")
fig1a <- readPicture(fig1a_file)
fig1a <- readPicture("./fig1a.svg")
fig1a_file <- system.file("svg", package = "grImport2")
fig1a <- readPicture("./fig1a.svg")
fig1a_file <- system.file("svg", "svg", package = "grImport2")
fig1a <- readPicture("./fig1a.svg", )
fig1a <- readPicture("./fig1a.svg")
readLines("./fig1a.svg")
fig1a <- readPicture("./fig1a.svg")
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
install.packages("rsvg")
install.packages("cowplot")
install.packages("magick")
library(ggplot2)
library(patchwork)
library(ggplot2)
library(cowplot)
library(rsvg)
library(magick)
load("../240328_RNAseq2nd/analysis/figure_RNAseq.rda")
load("../240415_baQFA/integrated_analysis/figure_integrated_analysis.rda")
fig1a_svg <- image_read_svg("./fig1a.svg")
library(grid)
fig1a_grob <- rasterGrob(image = as.raster(svg_img), width = unit(1, "npc"), height = unit(1, "npc"))
fig1a_grob <- rasterGrob(image = as.raster(fig1a_svg), width = unit(1, "npc"), height = unit(1, "npc"))
ggplot(mtcars, aes(x = mpg, y = disp)) +  # ggplot2パッケージ
geom_point() +  # ggplot2パッケージ
ggtitle("Scatter plot of mpg vs disp")
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
fig1a
fig1a
fig1a
fig1a_grob <- rasterGrob(image = fig1a_svg, width = unit(1, "npc"), height = unit(1, "npc"))
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
fig1a
fig1a
fig1a_grob <- rasterGrob(image = fig1a_svg, width = unit(100, "npc"), height = unit(100, "npc"))
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
fig1a
fig1a_grob <- rasterGrob(image = fig1a_svg)
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
fig1a
fig1a / plot_integrated
fig1a / plot_integrated
fig1a + plot_integrated
fig1a + plot_integrated / mds_plot
(fig1a + plot_integrated) / mds_plot
fig1a + plot_integrated / mds_plot
(fig1a + plot_integrated) / (mds_plot + heatmap)
wrap_plots(fig1a, plot_integrated, mds_plot, heatmap)
as.raster(heatmap)
rasterGrob(heatmap)
heatmap_grob <- grid.grabExpr(draw(heatmap, newpage=FALSE))
library(ComplexHeatmap)
heatmap_grob <- grid.grabExpr(draw(heatmap, newpage=FALSE))
heatmap_gg <- ggdraw() + draw_grob(heatmap_grob)
wrap_plots(fig1a, plot_integrated, mds_plot, heatmap_gg)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout(guides = 'collect')
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
fig1a <- ggdraw() +
draw_grob(fig1a_grob, width = 1, height = 1)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
fig1a <- ggdraw() +
draw_grob(fig1a_grob, width = 1, height = 1)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
fig1a <- ggdraw() +
draw_grob(fig1a_grob)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
fig1a <- ggdraw() +
draw_grob(fig1a_grob, width = 1, height = 1)
fig1a <- ggdraw() +
draw_grob(fig1a_grob, width = 1, height = 1)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
fig1a <- ggdraw() +
draw_grob(fig1a_grob) +
coord_fixed()
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
heatmap_gg <- ggdraw() + draw_grob(heatmap_grob) + coord_fixed()
fig1a_svg <- image_read_svg("./fig1a.svg")
fig1a_grob <- rasterGrob(image = as.raster(fig1a_svg), width = unit(1, "npc"), height = unit(1, "npc"))
fig1a <- ggdraw() +
draw_grob(fig1a_grob) +
coord_fixed()
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout()
(fig1a + plot_integrated)# / (mds_plot + heatmap_gg) + plot_layout()
heatmap_gg <- ggdraw() + draw_grob(heatmap_grob)
heatmap_gg
(fig1a + plot_integrated) / (mds_plot + heatmap_gg)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg) + plot_layout(widths = c(2, 1))
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
source("~/Documents/res-OT2/OT2_yeast/results/240521_fig_for_paper/make_figure.R", echo=TRUE)
(fig1a + plot_integrated) / (mds_plot + heatmap_gg)
mds_plot
mds_plot + guides(color = guide_legend(nrow = 2, byrow = TRUE))
mds_plot + guides(legend = guide_legend(nrow = 2, byrow = TRUE))
mds_plot + guides(color = guide_legend(nrow = 2, byrow = TRUE))
